<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: bank-alloc Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacebank-alloc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">bank-alloc Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afd1b1f0fb17eb9e3cae59713aca4f999"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#afd1b1f0fb17eb9e3cae59713aca4f999">retrieve_module_size</a> (<a class="el" href="namespacebank-alloc.html#a58ed1f4fc05e40edea694d9f889da543">file_name</a>)</td></tr>
<tr class="separator:afd1b1f0fb17eb9e3cae59713aca4f999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06300e60b46c2ff5fc21e0e420a3ea30"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a06300e60b46c2ff5fc21e0e420a3ea30">get_source_seg</a> (source_file, object_file, <a class="el" href="namespacebank-alloc.html#a63f1cf7f9a9db73b4b86c8b872b8c387">segment_rules</a>)</td></tr>
<tr class="separator:a06300e60b46c2ff5fc21e0e420a3ea30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7297315eab02168a9d459a17107446"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a3c7297315eab02168a9d459a17107446">get_object_seg</a> (object_file)</td></tr>
<tr class="separator:a3c7297315eab02168a9d459a17107446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28b7044fe4799483b62f8c0c03e2c83"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#aa28b7044fe4799483b62f8c0c03e2c83">get_total_size</a> (project)</td></tr>
<tr class="separator:aa28b7044fe4799483b62f8c0c03e2c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060f3f83fdcea66d8f30337685822a24"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a060f3f83fdcea66d8f30337685822a24">populate</a> (project, <a class="el" href="namespacebank-alloc.html#a7f721a262dd3d84c38ad13e9af027464">modules</a>, <a class="el" href="namespacebank-alloc.html#a63f1cf7f9a9db73b4b86c8b872b8c387">segment_rules</a>, <a class="el" href="namespacebank-alloc.html#a0198170f7f24331c2a737a50657cf904">bins</a>)</td></tr>
<tr class="separator:a060f3f83fdcea66d8f30337685822a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac94802355f424365211f23e9e047df98"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#ac94802355f424365211f23e9e047df98">bin_pack</a> (<a class="el" href="namespacebank-alloc.html#a7f721a262dd3d84c38ad13e9af027464">modules</a>, <a class="el" href="namespacebank-alloc.html#a0198170f7f24331c2a737a50657cf904">bins</a>, log)</td></tr>
<tr class="separator:ac94802355f424365211f23e9e047df98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e042e66a42e7935c1cac2af4269c88"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#ae8e042e66a42e7935c1cac2af4269c88">relocate</a> (module, bank)</td></tr>
<tr class="separator:ae8e042e66a42e7935c1cac2af4269c88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372c27bea6c0ae68344eeeb4fbfd228b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a372c27bea6c0ae68344eeeb4fbfd228b">usage</a> ()</td></tr>
<tr class="separator:a372c27bea6c0ae68344eeeb4fbfd228b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7f721a262dd3d84c38ad13e9af027464"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a7f721a262dd3d84c38ad13e9af027464">modules</a> = list()</td></tr>
<tr class="separator:a7f721a262dd3d84c38ad13e9af027464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58ed1f4fc05e40edea694d9f889da543"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a58ed1f4fc05e40edea694d9f889da543">file_name</a> = sys.argv[1]</td></tr>
<tr class="separator:a58ed1f4fc05e40edea694d9f889da543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69209e30b1130bed6d89e9718b948cef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a69209e30b1130bed6d89e9718b948cef">basename</a></td></tr>
<tr class="separator:a69209e30b1130bed6d89e9718b948cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6215e022267dc11d572ec677098947ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a6215e022267dc11d572ec677098947ab">ext</a></td></tr>
<tr class="separator:a6215e022267dc11d572ec677098947ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa93e3c58d0aa885ee5f234dd40c819"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a4fa93e3c58d0aa885ee5f234dd40c819">bankSize</a> = 0x8000</td></tr>
<tr class="separator:a4fa93e3c58d0aa885ee5f234dd40c819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a596e62b31573c0af7b50bbc5a8efc7f3"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a596e62b31573c0af7b50bbc5a8efc7f3">bankReserved</a> = {}</td></tr>
<tr class="separator:a596e62b31573c0af7b50bbc5a8efc7f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e83e44971dd2b43a998c95c3af1d98"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a50e83e44971dd2b43a998c95c3af1d98">bankError</a> = []</td></tr>
<tr class="separator:a50e83e44971dd2b43a998c95c3af1d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf2793bdfa6cac4fac935be1c97811b"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#aacf2793bdfa6cac4fac935be1c97811b">bankNonexist</a> = []</td></tr>
<tr class="separator:aacf2793bdfa6cac4fac935be1c97811b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7757d49b21fbaed24b9101ca93c23df2"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a7757d49b21fbaed24b9101ca93c23df2">bankLine</a> = &quot;----------------------------------------&quot;</td></tr>
<tr class="separator:a7757d49b21fbaed24b9101ca93c23df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed7ea92f45bd273dde380a45ddced592"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = int(sys.argv[2+x], 0)</td></tr>
<tr class="separator:aed7ea92f45bd273dde380a45ddced592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc988e70310af19475690a51952cc87"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a5fc988e70310af19475690a51952cc87">fw</a> = <a class="el" href="classuploader_1_1firmware.html">firmware</a>(<a class="el" href="namespacebank-alloc.html#a58ed1f4fc05e40edea694d9f889da543">file_name</a>)</td></tr>
<tr class="separator:a5fc988e70310af19475690a51952cc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25e9cb1a4ee50d632f545d179c8e3ecd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a25e9cb1a4ee50d632f545d179c8e3ecd">thisBank</a> = <a class="el" href="namespacebank-alloc.html#a4fa93e3c58d0aa885ee5f234dd40c819">bankSize</a>-<a class="el" href="namespacebank-alloc.html#a596e62b31573c0af7b50bbc5a8efc7f3">bankReserved</a>[bank]</td></tr>
<tr class="separator:a25e9cb1a4ee50d632f545d179c8e3ecd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f1cf7f9a9db73b4b86c8b872b8c387"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a63f1cf7f9a9db73b4b86c8b872b8c387">segment_rules</a> = sys.argv[2]</td></tr>
<tr class="separator:a63f1cf7f9a9db73b4b86c8b872b8c387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff89bc91a1b7016eca00ec9f9693f1c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#aeff89bc91a1b7016eca00ec9f9693f1c">seg</a> = <a class="el" href="namespacebank-alloc.html#a06300e60b46c2ff5fc21e0e420a3ea30">get_source_seg</a>(<a class="el" href="namespacebank-alloc.html#a58ed1f4fc05e40edea694d9f889da543">file_name</a>, sys.argv[3], <a class="el" href="namespacebank-alloc.html#a63f1cf7f9a9db73b4b86c8b872b8c387">segment_rules</a>)</td></tr>
<tr class="separator:aeff89bc91a1b7016eca00ec9f9693f1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1a5fa55d58daa4cccb9bf840af28a2d"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#af1a5fa55d58daa4cccb9bf840af28a2d">sizes</a> = {'total': 0, 'bankable': 0, 'user': 0, 'libs': 0}</td></tr>
<tr class="separator:af1a5fa55d58daa4cccb9bf840af28a2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0198170f7f24331c2a737a50657cf904"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a0198170f7f24331c2a737a50657cf904">bins</a></td></tr>
<tr class="separator:a0198170f7f24331c2a737a50657cf904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd9b56ee64587814208d57626dd0cb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a2bd9b56ee64587814208d57626dd0cb1">of</a> = open(<a class="el" href="namespacebank-alloc.html#a69209e30b1130bed6d89e9718b948cef">basename</a> + '.banks', 'w')</td></tr>
<tr class="separator:a2bd9b56ee64587814208d57626dd0cb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a494d5f53d3838090fc7841e90067e546"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a494d5f53d3838090fc7841e90067e546">pack</a> = <a class="el" href="namespacebank-alloc.html#ac94802355f424365211f23e9e047df98">bin_pack</a>(<a class="el" href="namespacebank-alloc.html#a7f721a262dd3d84c38ad13e9af027464">modules</a>, <a class="el" href="namespacebank-alloc.html#a0198170f7f24331c2a737a50657cf904">bins</a>, <a class="el" href="namespacebank-alloc.html#a2bd9b56ee64587814208d57626dd0cb1">of</a>)</td></tr>
<tr class="separator:a494d5f53d3838090fc7841e90067e546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce43e7ee3f7325696283c482eb6676e"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebank-alloc.html#a0ce43e7ee3f7325696283c482eb6676e">flags</a> = &quot;&quot;</td></tr>
<tr class="separator:a0ce43e7ee3f7325696283c482eb6676e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac94802355f424365211f23e9e047df98" name="ac94802355f424365211f23e9e047df98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac94802355f424365211f23e9e047df98">&#9670;&nbsp;</a></span>bin_pack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.bin_pack </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>log</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00128">128</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#ac94802355f424365211f23e9e047df98">bin_pack</a>(modules, bins, log):</div>
<div class="line"><span class="lineno">  129</span>    <span class="comment"># Sort by size, descending, in=place</span></div>
<div class="line"><span class="lineno">  130</span>    modules.sort(key=operator.itemgetter(1), reverse=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">for</span> module <span class="keywordflow">in</span> modules:</div>
<div class="line"><span class="lineno">  133</span>        <span class="comment"># We want to iterate in a specific order and dict.keys() won&#39;t do that</span></div>
<div class="line"><span class="lineno">  134</span>        <span class="keywordflow">for</span> bin_id <span class="keywordflow">in</span> [<span class="stringliteral">&#39;HOME&#39;</span>, <span class="stringliteral">&#39;BANK1&#39;</span>, <span class="stringliteral">&#39;BANK2&#39;</span>, <span class="stringliteral">&#39;BANK3&#39;</span>, <span class="stringliteral">&#39;BANK4&#39;</span>, <span class="stringliteral">&#39;BANK5&#39;</span>, <span class="stringliteral">&#39;BANK6&#39;</span>, <span class="stringliteral">&#39;BANK7&#39;</span>]:</div>
<div class="line"><span class="lineno">  135</span>            <span class="keywordflow">if</span> bins[bin_id][0] + module[1] &lt; bins[bin_id][1]:</div>
<div class="line"><span class="lineno">  136</span>                bins[bin_id][0] += module[1]</div>
<div class="line"><span class="lineno">  137</span>                module[2] = bin_id</div>
<div class="line"><span class="lineno">  138</span>                log.writelines(<span class="stringliteral">&#39;  &#39;</span>.join([module[2].ljust(8), \</div>
<div class="line"><span class="lineno">  139</span>                    <a class="code hl_variable" href="printfl_8c.html#a68d32aa355cb94fde33095156d18bc0b">str</a>(module[1]).rjust(5), module[0], <span class="stringliteral">&#39;\n&#39;</span>]))</div>
<div class="line"><span class="lineno">  140</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  142</span>                <span class="keywordflow">if</span> bin_id == <span class="stringliteral">&#39;BANK7&#39;</span>:</div>
<div class="line"><span class="lineno">  143</span>                    <span class="keywordflow">print</span> <span class="stringliteral">&quot;Failed to allocate&quot;</span>, module[0], <span class="stringliteral">&quot;with size&quot;</span>, module[1], \</div>
<div class="line"><span class="lineno">  144</span>                        <span class="stringliteral">&quot;to a code bank. This is fatal&quot;</span></div>
<div class="line"><span class="lineno">  145</span>                    <span class="keywordflow">return</span> 1</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">return</span> 0</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span><span class="comment"># Hack the new bank directly in the .rel file</span></div>
<div class="ttc" id="anamespacebank-alloc_html_ac94802355f424365211f23e9e047df98"><div class="ttname"><a href="namespacebank-alloc.html#ac94802355f424365211f23e9e047df98">bank-alloc.bin_pack</a></div><div class="ttdeci">def bin_pack(modules, bins, log)</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00128">bank-alloc.py:128</a></div></div>
<div class="ttc" id="aprintfl_8c_html_a68d32aa355cb94fde33095156d18bc0b"><div class="ttname"><a href="printfl_8c.html#a68d32aa355cb94fde33095156d18bc0b">str</a></div><div class="ttdeci">static char *__data str</div><div class="ttdef"><b>Definition:</b> <a href="printfl_8c_source.html#l00054">printfl.c:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c7297315eab02168a9d459a17107446" name="a3c7297315eab02168a9d459a17107446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7297315eab02168a9d459a17107446">&#9670;&nbsp;</a></span>get_object_seg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.get_object_seg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>object_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00077">77</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#a3c7297315eab02168a9d459a17107446">get_object_seg</a>(object_file):</div>
<div class="line"><span class="lineno">   78</span>    base, ext = os.path.splitext(object_file)</div>
<div class="line"><span class="lineno">   79</span>    seg = base + <span class="stringliteral">&#39;.seg&#39;</span></div>
<div class="line"><span class="lineno">   80</span>    bank = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">if</span> os.path.isfile(seg) <span class="keywordflow">is</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">   82</span>        of = open(base + <span class="stringliteral">&#39;.seg&#39;</span>, <span class="stringliteral">&#39;r&#39;</span>)</div>
<div class="line"><span class="lineno">   83</span>        bank = of.readline().strip()</div>
<div class="line"><span class="lineno">   84</span>        of.close()</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">return</span> bank</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span><span class="comment"># Open project.mem and retreive the project&#39;s total code footprint</span></div>
<div class="ttc" id="anamespacebank-alloc_html_a3c7297315eab02168a9d459a17107446"><div class="ttname"><a href="namespacebank-alloc.html#a3c7297315eab02168a9d459a17107446">bank-alloc.get_object_seg</a></div><div class="ttdeci">def get_object_seg(object_file)</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00077">bank-alloc.py:77</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebank-alloc_a3c7297315eab02168a9d459a17107446_icgraph.png" border="0" usemap="#anamespacebank-alloc_a3c7297315eab02168a9d459a17107446_icgraph" alt=""/></div>
<map name="anamespacebank-alloc_a3c7297315eab02168a9d459a17107446_icgraph" id="anamespacebank-alloc_a3c7297315eab02168a9d459a17107446_icgraph">
<area shape="rect" title=" " alt="" coords="124,5,235,32"/>
<area shape="rect" href="namespacebank-alloc.html#a060f3f83fdcea66d8f30337685822a24" title=" " alt="" coords="5,5,76,32"/>
</map>
</div>

</div>
</div>
<a id="a06300e60b46c2ff5fc21e0e420a3ea30" name="a06300e60b46c2ff5fc21e0e420a3ea30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06300e60b46c2ff5fc21e0e420a3ea30">&#9670;&nbsp;</a></span>get_source_seg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.get_source_seg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>source_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>object_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>segment_rules</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00055">55</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   55</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#a06300e60b46c2ff5fc21e0e420a3ea30">get_source_seg</a>(source_file, object_file, segment_rules):</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(segment_rules):</div>
<div class="line"><span class="lineno">   57</span>        tokens = line.split(<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">   58</span>        <span class="keywordflow">if</span> len(tokens) &lt; 2:</div>
<div class="line"><span class="lineno">   59</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">   60</span>        match = re.search(tokens[1], source_file.split(<span class="stringliteral">&#39;/&#39;</span>)[-1])</div>
<div class="line"><span class="lineno">   61</span>        <span class="keywordflow">if</span> match <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> <span class="stringliteral">&#39;.c&#39;</span> <span class="keywordflow">in</span> tokens[1]:</div>
<div class="line"><span class="lineno">   62</span>            <span class="comment"># Save it in basename.seg</span></div>
<div class="line"><span class="lineno">   63</span>            base, ext = os.path.splitext(object_file)</div>
<div class="line"><span class="lineno">   64</span>            if(<span class="keywordflow">not</span> os.path.exists(<span class="stringliteral">&#39;/&#39;</span>.join(base.split(<span class="stringliteral">&#39;/&#39;</span>)[:-1]))):</div>
<div class="line"><span class="lineno">   65</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   66</span>                    os.makedirs(<span class="stringliteral">&#39;/&#39;</span>.join(base.split(<span class="stringliteral">&#39;/&#39;</span>)[:-1]))</div>
<div class="line"><span class="lineno">   67</span>                <span class="keywordflow">except</span> OSError:</div>
<div class="line"><span class="lineno">   68</span>                    <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   69</span>            of = open(base+<span class="stringliteral">&#39;.seg&#39;</span>, <span class="stringliteral">&#39;w&#39;</span>)</div>
<div class="line"><span class="lineno">   70</span>            of.write(tokens[0] + <span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><span class="lineno">   71</span>            of.close</div>
<div class="line"><span class="lineno">   72</span>            <span class="keywordflow">return</span> tokens[0]</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span><span class="comment"># If segment.rules specified a rule for a source file, the respective object</span></div>
<div class="line"><span class="lineno">   76</span><span class="comment"># file&#39;s banking requirement will be stored in object_file.seg</span></div>
<div class="ttc" id="anamespacebank-alloc_html_a06300e60b46c2ff5fc21e0e420a3ea30"><div class="ttname"><a href="namespacebank-alloc.html#a06300e60b46c2ff5fc21e0e420a3ea30">bank-alloc.get_source_seg</a></div><div class="ttdeci">def get_source_seg(source_file, object_file, segment_rules)</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00055">bank-alloc.py:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa28b7044fe4799483b62f8c0c03e2c83" name="aa28b7044fe4799483b62f8c0c03e2c83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa28b7044fe4799483b62f8c0c03e2c83">&#9670;&nbsp;</a></span>get_total_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.get_total_size </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00088">88</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   88</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#aa28b7044fe4799483b62f8c0c03e2c83">get_total_size</a>(project):</div>
<div class="line"><span class="lineno">   89</span>    mem_file = project + <span class="stringliteral">&#39;.mem&#39;</span></div>
<div class="line"><span class="lineno">   90</span>    pat = re.compile(<span class="stringliteral">&#39;FLASH\s+(0x[0-9a-f]+\s+){2}([0-9]+)&#39;</span>)</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(mem_file):</div>
<div class="line"><span class="lineno">   92</span>        l = pat.search(line)</div>
<div class="line"><span class="lineno">   93</span>        <span class="keywordflow">if</span> l <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   94</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceatcommander.html#a61569f2965b7a369eb10b6d75d410d11">int</a>(l.group(2))</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span><span class="comment"># Open project.map and retrieve the list of modules linked in</span></div>
<div class="line"><span class="lineno">   97</span><span class="comment"># This will only consider contiki sources, not SDCC libraries</span></div>
<div class="line"><span class="lineno">   98</span><span class="comment"># NB: Sometimes object filenames get truncated:</span></div>
<div class="line"><span class="lineno">   99</span><span class="comment"># contiki-sensinode.lib                     [ obj_sensinode/watchdog-cc2430.re ]</span></div>
<div class="line"><span class="lineno">  100</span><span class="comment"># See how for this file the &#39;l&#39; in &#39;rel&#39; is missing. For that reason, we retrieve</span></div>
<div class="line"><span class="lineno">  101</span><span class="comment"># the filaname until the last &#39;.&#39; but without the extension and we append &#39;rel&#39;</span></div>
<div class="line"><span class="lineno">  102</span><span class="comment"># As long as the filename doesn&#39;t get truncated, we&#39;re good</span></div>
<div class="ttc" id="anamespaceatcommander_html_a61569f2965b7a369eb10b6d75d410d11"><div class="ttname"><a href="namespaceatcommander.html#a61569f2965b7a369eb10b6d75d410d11">atcommander.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="atcommander_8py_source.html#l00247">atcommander.py:247</a></div></div>
<div class="ttc" id="anamespacebank-alloc_html_aa28b7044fe4799483b62f8c0c03e2c83"><div class="ttname"><a href="namespacebank-alloc.html#aa28b7044fe4799483b62f8c0c03e2c83">bank-alloc.get_total_size</a></div><div class="ttdeci">def get_total_size(project)</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00088">bank-alloc.py:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a060f3f83fdcea66d8f30337685822a24" name="a060f3f83fdcea66d8f30337685822a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a060f3f83fdcea66d8f30337685822a24">&#9670;&nbsp;</a></span>populate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.populate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>segment_rules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00103">103</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  103</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#a060f3f83fdcea66d8f30337685822a24">populate</a>(project, modules, segment_rules, bins):</div>
<div class="line"><span class="lineno">  104</span>    bankable_total = 0</div>
<div class="line"><span class="lineno">  105</span>    user_total = 0</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    map_file = project + <span class="stringliteral">&#39;.map&#39;</span></div>
<div class="line"><span class="lineno">  108</span>    file_pat = re.compile(<span class="stringliteral">&quot;%s[^ ]+\.&quot;</span>%<span class="stringliteral">&quot;/&quot;</span>.join(project.split(<span class="stringliteral">&quot;/&quot;</span>)[:-1]))</div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">for</span> line <span class="keywordflow">in</span> open(map_file):</div>
<div class="line"><span class="lineno">  110</span>        file_name = file_pat.search(line)</div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">if</span> file_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  112</span>            mod = file_name.group(0) + <span class="stringliteral">&#39;rel&#39;</span></div>
<div class="line"><span class="lineno">  113</span>            code_size = <a class="code hl_function" href="namespacebank-alloc.html#afd1b1f0fb17eb9e3cae59713aca4f999">retrieve_module_size</a>(mod)</div>
<div class="line"><span class="lineno">  114</span>            seg = <a class="code hl_function" href="namespacebank-alloc.html#a3c7297315eab02168a9d459a17107446">get_object_seg</a>(mod)</div>
<div class="line"><span class="lineno">  115</span>            <span class="keywordflow">if</span> seg <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  116</span>                <span class="comment"># This module has been assigned to a bank by the user</span></div>
<div class="line"><span class="lineno">  117</span>                <span class="comment">#print &#39;In&#39;, seg, file_name.group(0), &#39;size&#39;, code_size</span></div>
<div class="line"><span class="lineno">  118</span>                bins[seg][0] += code_size</div>
<div class="line"><span class="lineno">  119</span>                user_total += code_size</div>
<div class="line"><span class="lineno">  120</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  121</span>                <span class="comment"># We are free to allocate this module</span></div>
<div class="line"><span class="lineno">  122</span>                modules.append([mod, code_size, <span class="stringliteral">&quot;NONE&quot;</span>])</div>
<div class="line"><span class="lineno">  123</span>                bankable_total += code_size</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">return</span> bankable_total, user_total</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span><span class="comment"># Allocate bankable modules to banks according to a simple</span></div>
<div class="line"><span class="lineno">  127</span><span class="comment"># &#39;first fit, decreasing&#39; bin packing heuristic.</span></div>
<div class="ttc" id="anamespacebank-alloc_html_a060f3f83fdcea66d8f30337685822a24"><div class="ttname"><a href="namespacebank-alloc.html#a060f3f83fdcea66d8f30337685822a24">bank-alloc.populate</a></div><div class="ttdeci">def populate(project, modules, segment_rules, bins)</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00103">bank-alloc.py:103</a></div></div>
<div class="ttc" id="anamespacebank-alloc_html_afd1b1f0fb17eb9e3cae59713aca4f999"><div class="ttname"><a href="namespacebank-alloc.html#afd1b1f0fb17eb9e3cae59713aca4f999">bank-alloc.retrieve_module_size</a></div><div class="ttdeci">def retrieve_module_size(file_name)</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00045">bank-alloc.py:45</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebank-alloc_a060f3f83fdcea66d8f30337685822a24_cgraph.png" border="0" usemap="#anamespacebank-alloc_a060f3f83fdcea66d8f30337685822a24_cgraph" alt=""/></div>
<map name="anamespacebank-alloc_a060f3f83fdcea66d8f30337685822a24_cgraph" id="anamespacebank-alloc_a060f3f83fdcea66d8f30337685822a24_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,76,57"/>
<area shape="rect" href="namespacebank-alloc.html#a3c7297315eab02168a9d459a17107446" title=" " alt="" coords="140,5,251,32"/>
<area shape="rect" href="namespacebank-alloc.html#afd1b1f0fb17eb9e3cae59713aca4f999" title=" " alt="" coords="124,56,267,83"/>
</map>
</div>

</div>
</div>
<a id="ae8e042e66a42e7935c1cac2af4269c88" name="ae8e042e66a42e7935c1cac2af4269c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e042e66a42e7935c1cac2af4269c88">&#9670;&nbsp;</a></span>relocate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.relocate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00149">149</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#ae8e042e66a42e7935c1cac2af4269c88">relocate</a>(module, bank):</div>
<div class="line"><span class="lineno">  150</span>    code_pat = re.compile(<span class="stringliteral">&#39;(A\s+)(?:HOME|BANK[0-9])(\s+size\s+[1-9A-F][0-9A-F]*.+\n)&#39;</span>)</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">for</span> line <span class="keywordflow">in</span> fileinput.input(module, inplace=1):</div>
<div class="line"><span class="lineno">  153</span>        m = code_pat.search(line)</div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">if</span> m <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  155</span>            line = m.group(1) + bank + m.group(2)</div>
<div class="line"><span class="lineno">  156</span>        sys.stdout.write(line)</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="ttc" id="anamespacebank-alloc_html_ae8e042e66a42e7935c1cac2af4269c88"><div class="ttname"><a href="namespacebank-alloc.html#ae8e042e66a42e7935c1cac2af4269c88">bank-alloc.relocate</a></div><div class="ttdeci">def relocate(module, bank)</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00149">bank-alloc.py:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd1b1f0fb17eb9e3cae59713aca4f999" name="afd1b1f0fb17eb9e3cae59713aca4f999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd1b1f0fb17eb9e3cae59713aca4f999">&#9670;&nbsp;</a></span>retrieve_module_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.retrieve_module_size </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>file_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00045">45</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#afd1b1f0fb17eb9e3cae59713aca4f999">retrieve_module_size</a>(file_name):</div>
<div class="line"><span class="lineno">   46</span>    size_pat = re.compile(<span class="stringliteral">&#39;^A\s+(?:HOME|BANK[0-9])\s+size\s+([1-9A-F][0-9A-F]*)&#39;</span>)</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">for</span> code_line <span class="keywordflow">in</span> open(file_name):</div>
<div class="line"><span class="lineno">   48</span>        matches = size_pat.search(code_line)</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">if</span> matches <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   50</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceatcommander.html#a61569f2965b7a369eb10b6d75d410d11">int</a>(matches.group(1), 16)</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">return</span> 0</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span><span class="comment"># Searches for a code segment rule for file_name in the segment_rules file</span></div>
<div class="line"><span class="lineno">   54</span><span class="comment"># If there is a rule, we respect it. Otherwise, we can move the file around</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebank-alloc_afd1b1f0fb17eb9e3cae59713aca4f999_icgraph.png" border="0" usemap="#anamespacebank-alloc_afd1b1f0fb17eb9e3cae59713aca4f999_icgraph" alt=""/></div>
<map name="anamespacebank-alloc_afd1b1f0fb17eb9e3cae59713aca4f999_icgraph" id="anamespacebank-alloc_afd1b1f0fb17eb9e3cae59713aca4f999_icgraph">
<area shape="rect" title=" " alt="" coords="124,5,267,32"/>
<area shape="rect" href="namespacebank-alloc.html#a060f3f83fdcea66d8f30337685822a24" title=" " alt="" coords="5,5,76,32"/>
</map>
</div>

</div>
</div>
<a id="a372c27bea6c0ae68344eeeb4fbfd228b" name="a372c27bea6c0ae68344eeeb4fbfd228b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a372c27bea6c0ae68344eeeb4fbfd228b">&#9670;&nbsp;</a></span>usage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def bank-alloc.usage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00159">159</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  159</span><span class="keyword">def </span><a class="code hl_function" href="namespacebank-alloc.html#a372c27bea6c0ae68344eeeb4fbfd228b">usage</a>():</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">print</span> <span class="stringliteral">&#39;Usage:&#39;</span></div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">print</span> <span class="stringliteral">&#39;bank-alloc.py project path_to_segment_rules [offset]&#39;</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">print</span> <span class="stringliteral">&#39;bank-alloc.py source_file path_to_segment_rules project&#39;</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">print</span> <span class="stringliteral">&#39;bank-alloc.py hex_file [offset]&#39;</span></div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="ttc" id="anamespacebank-alloc_html_a372c27bea6c0ae68344eeeb4fbfd228b"><div class="ttname"><a href="namespacebank-alloc.html#a372c27bea6c0ae68344eeeb4fbfd228b">bank-alloc.usage</a></div><div class="ttdeci">def usage()</div><div class="ttdef"><b>Definition:</b> <a href="bank-alloc_8py_source.html#l00159">bank-alloc.py:159</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_cgraph.png" border="0" usemap="#anamespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_cgraph" alt=""/></div>
<map name="anamespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_cgraph" id="anamespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,63,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_icgraph.png" border="0" usemap="#anamespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_icgraph" alt=""/></div>
<map name="anamespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_icgraph" id="anamespacebank-alloc_a372c27bea6c0ae68344eeeb4fbfd228b_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,63,56"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a50e83e44971dd2b43a998c95c3af1d98" name="a50e83e44971dd2b43a998c95c3af1d98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50e83e44971dd2b43a998c95c3af1d98">&#9670;&nbsp;</a></span>bankError</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list bankError = []</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00187">187</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a7757d49b21fbaed24b9101ca93c23df2" name="a7757d49b21fbaed24b9101ca93c23df2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7757d49b21fbaed24b9101ca93c23df2">&#9670;&nbsp;</a></span>bankLine</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string bankLine = &quot;----------------------------------------&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00189">189</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="aacf2793bdfa6cac4fac935be1c97811b" name="aacf2793bdfa6cac4fac935be1c97811b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf2793bdfa6cac4fac935be1c97811b">&#9670;&nbsp;</a></span>bankNonexist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list bankNonexist = []</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00188">188</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a596e62b31573c0af7b50bbc5a8efc7f3" name="a596e62b31573c0af7b50bbc5a8efc7f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a596e62b31573c0af7b50bbc5a8efc7f3">&#9670;&nbsp;</a></span>bankReserved</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dictionary bankReserved = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00186">186</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a4fa93e3c58d0aa885ee5f234dd40c819" name="a4fa93e3c58d0aa885ee5f234dd40c819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa93e3c58d0aa885ee5f234dd40c819">&#9670;&nbsp;</a></span>bankSize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bankSize = 0x8000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00185">185</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a69209e30b1130bed6d89e9718b948cef" name="a69209e30b1130bed6d89e9718b948cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69209e30b1130bed6d89e9718b948cef">&#9670;&nbsp;</a></span>basename</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">basename</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00175">175</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a0198170f7f24331c2a737a50657cf904" name="a0198170f7f24331c2a737a50657cf904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0198170f7f24331c2a737a50657cf904">&#9670;&nbsp;</a></span>bins</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dictionary bins</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&#39;HOME&#39;</span>:  [0, 32768, <span class="stringliteral">&#39;0x000000&#39;</span>],</div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&#39;BANK1&#39;</span>: [0, 32768, <span class="stringliteral">&#39;0x018000&#39;</span>],</div>
<div class="line"><span class="lineno">    4</span>    <span class="stringliteral">&#39;BANK2&#39;</span>: [0, 32768, <span class="stringliteral">&#39;0x028000&#39;</span>],</div>
<div class="line"><span class="lineno">    5</span>    <span class="stringliteral">&#39;BANK3&#39;</span>: [0, 32768, <span class="stringliteral">&#39;0x038000&#39;</span>],</div>
<div class="line"><span class="lineno">    6</span>    <span class="stringliteral">&#39;BANK4&#39;</span>: [0, 32768, <span class="stringliteral">&#39;0x048000&#39;</span>],</div>
<div class="line"><span class="lineno">    7</span>    <span class="stringliteral">&#39;BANK5&#39;</span>: [0, 32768, <span class="stringliteral">&#39;0x058000&#39;</span>],</div>
<div class="line"><span class="lineno">    8</span>    <span class="stringliteral">&#39;BANK6&#39;</span>: [0, 32768, <span class="stringliteral">&#39;0x068000&#39;</span>],</div>
<div class="line"><span class="lineno">    9</span>    <span class="stringliteral">&#39;BANK7&#39;</span>: [0, 32768, <span class="stringliteral">&#39;0x078000&#39;</span>],</div>
<div class="line"><span class="lineno">   10</span>}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00277">277</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a6215e022267dc11d572ec677098947ab" name="a6215e022267dc11d572ec677098947ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6215e022267dc11d572ec677098947ab">&#9670;&nbsp;</a></span>ext</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ext</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00175">175</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a58ed1f4fc05e40edea694d9f889da543" name="a58ed1f4fc05e40edea694d9f889da543"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58ed1f4fc05e40edea694d9f889da543">&#9670;&nbsp;</a></span>file_name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">file_name = sys.argv[1]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00171">171</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a0ce43e7ee3f7325696283c482eb6676e" name="a0ce43e7ee3f7325696283c482eb6676e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce43e7ee3f7325696283c482eb6676e">&#9670;&nbsp;</a></span>flags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string flags = &quot;&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00356">356</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a5fc988e70310af19475690a51952cc87" name="a5fc988e70310af19475690a51952cc87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fc988e70310af19475690a51952cc87">&#9670;&nbsp;</a></span>fw</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fw = <a class="el" href="classuploader_1_1firmware.html">firmware</a>(<a class="el" href="namespacebank-alloc.html#a58ed1f4fc05e40edea694d9f889da543">file_name</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00205">205</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a7f721a262dd3d84c38ad13e9af027464" name="a7f721a262dd3d84c38ad13e9af027464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f721a262dd3d84c38ad13e9af027464">&#9670;&nbsp;</a></span>modules</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">modules = list()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00170">170</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a2bd9b56ee64587814208d57626dd0cb1" name="a2bd9b56ee64587814208d57626dd0cb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd9b56ee64587814208d57626dd0cb1">&#9670;&nbsp;</a></span>of</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">of = open(<a class="el" href="namespacebank-alloc.html#a69209e30b1130bed6d89e9718b948cef">basename</a> + '.banks', 'w')</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00331">331</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="aed7ea92f45bd273dde380a45ddced592" name="aed7ea92f45bd273dde380a45ddced592"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed7ea92f45bd273dde380a45ddced592">&#9670;&nbsp;</a></span>offset</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int offset = int(sys.argv[2+x], 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00194">194</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a494d5f53d3838090fc7841e90067e546" name="a494d5f53d3838090fc7841e90067e546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a494d5f53d3838090fc7841e90067e546">&#9670;&nbsp;</a></span>pack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pack = <a class="el" href="namespacebank-alloc.html#ac94802355f424365211f23e9e047df98">bin_pack</a>(<a class="el" href="namespacebank-alloc.html#a7f721a262dd3d84c38ad13e9af027464">modules</a>, <a class="el" href="namespacebank-alloc.html#a0198170f7f24331c2a737a50657cf904">bins</a>, <a class="el" href="namespacebank-alloc.html#a2bd9b56ee64587814208d57626dd0cb1">of</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00332">332</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="aeff89bc91a1b7016eca00ec9f9693f1c" name="aeff89bc91a1b7016eca00ec9f9693f1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeff89bc91a1b7016eca00ec9f9693f1c">&#9670;&nbsp;</a></span>seg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def seg = <a class="el" href="namespacebank-alloc.html#a06300e60b46c2ff5fc21e0e420a3ea30">get_source_seg</a>(<a class="el" href="namespacebank-alloc.html#a58ed1f4fc05e40edea694d9f889da543">file_name</a>, sys.argv[3], <a class="el" href="namespacebank-alloc.html#a63f1cf7f9a9db73b4b86c8b872b8c387">segment_rules</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00266">266</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a63f1cf7f9a9db73b4b86c8b872b8c387" name="a63f1cf7f9a9db73b4b86c8b872b8c387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63f1cf7f9a9db73b4b86c8b872b8c387">&#9670;&nbsp;</a></span>segment_rules</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">segment_rules = sys.argv[2]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00255">255</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="af1a5fa55d58daa4cccb9bf840af28a2d" name="af1a5fa55d58daa4cccb9bf840af28a2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1a5fa55d58daa4cccb9bf840af28a2d">&#9670;&nbsp;</a></span>sizes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dictionary sizes = {'total': 0, 'bankable': 0, 'user': 0, 'libs': 0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00274">274</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
<a id="a25e9cb1a4ee50d632f545d179c8e3ecd" name="a25e9cb1a4ee50d632f545d179c8e3ecd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25e9cb1a4ee50d632f545d179c8e3ecd">&#9670;&nbsp;</a></span>thisBank</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thisBank = <a class="el" href="namespacebank-alloc.html#a4fa93e3c58d0aa885ee5f234dd40c819">bankSize</a>-<a class="el" href="namespacebank-alloc.html#a596e62b31573c0af7b50bbc5a8efc7f3">bankReserved</a>[bank]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bank-alloc_8py_source.html#l00213">213</a> of file <a class="el" href="bank-alloc_8py_source.html">bank-alloc.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacebank-alloc.html">bank-alloc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
