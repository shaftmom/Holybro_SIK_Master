<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: C:/project/Firmware/radio/AES/aes.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('aes_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">aes.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &quot;<a class="el" href="radio_8h_source.html">../radio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_generate_decryption_key_8h_source.html">GenerateDecryptionKey.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_a_e_s___block_cipher_8h_source.html">AES_BlockCipher.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_c_b_c___encrypt_decrypt_8h_source.html">CBC_EncryptDecrypt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_c_t_r___encrypt_decrypt_8h_source.html">CTR_EncryptDecrypt.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for aes.c:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c__incl.png" border="0" usemap="#a_c_1_2project_2_firmware_2radio_2_a_e_s_2aes_8c" alt=""/></div>
<map name="a_c_1_2project_2_firmware_2radio_2_a_e_s_2aes_8c" id="a_c_1_2project_2_firmware_2radio_2_a_e_s_2aes_8c">
<area shape="rect" title=" " alt="" coords="250,5,385,47"/>
<area shape="rect" title=" " alt="" coords="5,319,75,345"/>
<area shape="rect" href="radio_8h.html" title=" " alt="" coords="498,244,571,271"/>
<area shape="rect" title=" " alt="" coords="99,319,163,345"/>
<area shape="rect" href="_generate_decryption_key_8h.html" title=" " alt="" coords="232,95,403,121"/>
<area shape="rect" href="_a_e_s___block_cipher_8h.html" title=" " alt="" coords="427,95,565,121"/>
<area shape="rect" href="_c_b_c___encrypt_decrypt_8h.html" title=" " alt="" coords="589,95,747,121"/>
<area shape="rect" href="_c_t_r___encrypt_decrypt_8h.html" title=" " alt="" coords="771,95,925,121"/>
<area shape="rect" title=" " alt="" coords="413,319,478,345"/>
<area shape="rect" title=" " alt="" coords="571,393,637,420"/>
<area shape="rect" title=" " alt="" coords="696,393,771,420"/>
<area shape="rect" title=" " alt="" coords="807,319,873,345"/>
<area shape="rect" href="board_8h.html" title=" " alt="" coords="897,319,962,345"/>
<area shape="rect" href="serial_8h.html" title=" " alt="" coords="503,319,567,345"/>
<area shape="rect" href="board__info_8h.html" title=" " alt="" coords="986,319,1078,345"/>
<area shape="rect" href="pins__user_8h.html" title=" " alt="" coords="642,319,731,345"/>
<area shape="rect" href="parameters_8h.html" title=" " alt="" coords="1103,319,1201,345"/>
<area shape="rect" href="at_8h.html" title=" " alt="" coords="187,319,231,345"/>
<area shape="rect" href="radio_2flash_8h.html" title=" " alt="" coords="255,319,315,345"/>
<area shape="rect" href="rtc_8h.html" title=" " alt="" coords="340,319,388,345"/>
<area shape="rect" href="compiler__defs_8h.html" title=" " alt="" coords="603,244,717,271"/>
<area shape="rect" href="_a_e_s__defs_8h.html" title=" " alt="" coords="489,169,580,196"/>
<area shape="rect" href="cdt_8h.html" title=" " alt="" coords="1225,319,1276,345"/>
</map>
</div>
</div>
<p><a href="aes_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a941c7647f6eb232d5d8e5e736c51b05e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a941c7647f6eb232d5d8e5e736c51b05e">MAX_ENCRYPT_PACKET_LENGTH</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a941c7647f6eb232d5d8e5e736c51b05e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f72d2df0c60ca20c904e74bf08a5e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a72f72d2df0c60ca20c904e74bf08a5e8">BITS</a>(_l)&#160;&#160;&#160;(_l)&amp;0xf</td></tr>
<tr class="separator:a72f72d2df0c60ca20c904e74bf08a5e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6302156c124f3a1ca3b0f66f9660a64e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a6302156c124f3a1ca3b0f66f9660a64e">CRYPTO</a>(_l)&#160;&#160;&#160;(_l&gt;&gt;4)&amp;0xf</td></tr>
<tr class="separator:a6302156c124f3a1ca3b0f66f9660a64e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2e599e112e6acafda51081c4ca4fbcf8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a2e599e112e6acafda51081c4ca4fbcf8">SEGMENT_VARIABLE</a> (DecryptionKey[32], U8, SEG_XDATA)</td></tr>
<tr class="separator:a2e599e112e6acafda51081c4ca4fbcf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dc14eb3453afebb659240b6f0163fd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a0dc14eb3453afebb659240b6f0163fd3">SEGMENT_VARIABLE</a> (InitialVector[16], U8, SEG_XDATA)</td></tr>
<tr class="separator:a0dc14eb3453afebb659240b6f0163fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec66ec87d73d65517e9493b838a461a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a3ec66ec87d73d65517e9493b838a461a">SEGMENT_VARIABLE</a> (Counter[16], U8, SEG_XDATA)</td></tr>
<tr class="separator:a3ec66ec87d73d65517e9493b838a461a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66557124ad1cbe4739c59fbd3e349de1"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a66557124ad1cbe4739c59fbd3e349de1">SEGMENT_VARIABLE</a> (Nonce[16], U8, SEG_CODE)</td></tr>
<tr class="separator:a66557124ad1cbe4739c59fbd3e349de1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05d3f9b0caaac236e8b2d6b2b6825091"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a05d3f9b0caaac236e8b2d6b2b6825091">SEGMENT_VARIABLE</a> (ReferenceInitialVector[16], U8, SEG_CODE)</td></tr>
<tr class="separator:a05d3f9b0caaac236e8b2d6b2b6825091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3340193121d38a9a5c492e1df5529da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#ad3340193121d38a9a5c492e1df5529da">INTERRUPT</a> (DMA_ISR, <a class="el" href="_si1020__defs_8h.html#a7f9c4337d8bafd18441e4eee6a413847">INTERRUPT_DMA0</a>)</td></tr>
<tr class="separator:ad3340193121d38a9a5c492e1df5529da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d425db069534a0125d42f764e943cee"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a4d425db069534a0125d42f764e943cee">aes_get_encryption_level</a> ()</td></tr>
<tr class="separator:a4d425db069534a0125d42f764e943cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ef8c9a7a8598356f81d0fa4b18fd1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a16ef8c9a7a8598356f81d0fa4b18fd1c">aes_set_encryption_level</a> (uint8_t encryption)</td></tr>
<tr class="separator:a16ef8c9a7a8598356f81d0fa4b18fd1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d20556fe1e702da2bed17db92095443"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a1d20556fe1e702da2bed17db92095443">aes_initkey</a> ()</td></tr>
<tr class="separator:a1d20556fe1e702da2bed17db92095443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b40943f7b432a2e9e78a8fb5f5759e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6">aesCopyInit2</a> (__xdata unsigned char *dest, __code unsigned char *source)</td></tr>
<tr class="separator:a1b40943f7b432a2e9e78a8fb5f5759e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60cde6c8c3083b96d4a0a2977c14f243"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a60cde6c8c3083b96d4a0a2977c14f243">aes_init</a> (uint8_t <a class="el" href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a>)</td></tr>
<tr class="separator:a60cde6c8c3083b96d4a0a2977c14f243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f0b7e8b1dd9c73ef8d91552e55d538b"><td class="memItemLeft" align="right" valign="top">__xdata unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a4f0b7e8b1dd9c73ef8d91552e55d538b">aes_pad</a> (__xdata unsigned char *in_str, uint8_t len)</td></tr>
<tr class="separator:a4f0b7e8b1dd9c73ef8d91552e55d538b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ab42619f8a65c17754fb46b3e0dfac"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#ac3ab42619f8a65c17754fb46b3e0dfac">aes_encrypt</a> (__xdata unsigned char *in_str, uint8_t in_len, __xdata unsigned char *out_str, uint8_t *out_len)</td></tr>
<tr class="separator:ac3ab42619f8a65c17754fb46b3e0dfac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2757ace1790e3c4735f71d304bc3c58b"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a2757ace1790e3c4735f71d304bc3c58b">aes_decrypt</a> (__xdata unsigned char *in_str, uint8_t in_len, __xdata unsigned char *out_str, uint8_t *out_len)</td></tr>
<tr class="separator:a2757ace1790e3c4735f71d304bc3c58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a154f11ed8a65a8d0e4b925b1eaa467ed"><td class="memItemLeft" align="right" valign="top">__xdata unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a></td></tr>
<tr class="separator:a154f11ed8a65a8d0e4b925b1eaa467ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930fb15b8006f70d704902a7118794c6"><td class="memItemLeft" align="right" valign="top">static __xdata uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a930fb15b8006f70d704902a7118794c6">encrypt_packet</a> [<a class="el" href="aes_8c.html#a941c7647f6eb232d5d8e5e736c51b05e">MAX_ENCRYPT_PACKET_LENGTH</a>]</td></tr>
<tr class="separator:a930fb15b8006f70d704902a7118794c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b2fc566005e9dace81fd13ce88281e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a></td></tr>
<tr class="separator:a25b2fc566005e9dace81fd13ce88281e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a72f72d2df0c60ca20c904e74bf08a5e8" name="a72f72d2df0c60ca20c904e74bf08a5e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72f72d2df0c60ca20c904e74bf08a5e8">&#9670;&nbsp;</a></span>BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BITS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_l</td><td>)</td>
          <td>&#160;&#160;&#160;(_l)&amp;0xf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00056">56</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<a id="a6302156c124f3a1ca3b0f66f9660a64e" name="a6302156c124f3a1ca3b0f66f9660a64e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6302156c124f3a1ca3b0f66f9660a64e">&#9670;&nbsp;</a></span>CRYPTO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_l</td><td>)</td>
          <td>&#160;&#160;&#160;(_l&gt;&gt;4)&amp;0xf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00058">58</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<a id="a941c7647f6eb232d5d8e5e736c51b05e" name="a941c7647f6eb232d5d8e5e736c51b05e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a941c7647f6eb232d5d8e5e736c51b05e">&#9670;&nbsp;</a></span>MAX_ENCRYPT_PACKET_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ENCRYPT_PACKET_LENGTH&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00038">38</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2757ace1790e3c4735f71d304bc3c58b" name="a2757ace1790e3c4735f71d304bc3c58b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2757ace1790e3c4735f71d304bc3c58b">&#9670;&nbsp;</a></span>aes_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t aes_decrypt </td>
          <td>(</td>
          <td class="paramtype">__xdata unsigned char *&#160;</td>
          <td class="paramname"><em>in_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>in_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xdata unsigned char *&#160;</td>
          <td class="paramname"><em>out_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00272">272</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  274</span>{</div>
<div class="line"><span class="lineno">  275</span>    uint8_t encryption;</div>
<div class="line"><span class="lineno">  276</span>    uint8_t crypto_type;</div>
<div class="line"><span class="lineno">  277</span>    int8_t key_size_code;</div>
<div class="line"><span class="lineno">  278</span>    uint8_t status;</div>
<div class="line"><span class="lineno">  279</span>    uint8_t blocks;</div>
<div class="line"><span class="lineno">  280</span>    __xdata <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *ct;</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    <span class="comment">// Make sure we have something to decrypt</span></div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">if</span> (in_len == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    <span class="comment">// Get Encryption Level</span></div>
<div class="line"><span class="lineno">  286</span>    encryption = <a class="code hl_function" href="aes_8c.html#a4d425db069534a0125d42f764e943cee">aes_get_encryption_level</a>();</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">// From the encryption level, determine code for # of bits for AES functions</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">// DECRYPTION_128_BITS = 0,            // 0x00</span></div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">// DECRYPTION_192_BITS,                // 0x01</span></div>
<div class="line"><span class="lineno">  291</span>    <span class="comment">// DECRYPTION_256_BITS,                // 0x02</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">switch</span> (<a class="code hl_define" href="aes_8c.html#a72f72d2df0c60ca20c904e74bf08a5e8">BITS</a>(encryption))</div>
<div class="line"><span class="lineno">  293</span>    {</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  295</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810a9bb591df6a7d0b56c4f93f9f55d2ae30">DECRYPTION_128_BITS</a>;</div>
<div class="line"><span class="lineno">  296</span>            <span class="keywordflow">break</span>;  </div>
<div class="line"><span class="lineno">  297</span>        <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno">  298</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810a25964629f17803f5ba91a4a2e17be6d1">DECRYPTION_192_BITS</a>;</div>
<div class="line"><span class="lineno">  299</span>            <span class="keywordflow">break</span>;  </div>
<div class="line"><span class="lineno">  300</span>        <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno">  301</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810ae16f041068db0909c54ca8a167a51fa6">DECRYPTION_256_BITS</a>;</div>
<div class="line"><span class="lineno">  302</span>            <span class="keywordflow">break</span>;  </div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  304</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810a9bb591df6a7d0b56c4f93f9f55d2ae30">DECRYPTION_128_BITS</a>;</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="comment">// Get crypto type...</span></div>
<div class="line"><span class="lineno">  309</span>    <span class="comment">// 0 - CBC</span></div>
<div class="line"><span class="lineno">  310</span>    <span class="comment">// 1 - CTR</span></div>
<div class="line"><span class="lineno">  311</span>    crypto_type = <a class="code hl_define" href="aes_8c.html#a6302156c124f3a1ca3b0f66f9660a64e">CRYPTO</a>(encryption);</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="comment">// Calculate # of 16-byte blocks</span></div>
<div class="line"><span class="lineno">  314</span>    blocks = in_len&gt;&gt;4; </div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="comment">// Initialise CipherText</span></div>
<div class="line"><span class="lineno">  317</span>    ct = in_str; </div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">// Based on crypto_type, perform the decryption</span></div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">switch</span>(crypto_type)</div>
<div class="line"><span class="lineno">  321</span>    {</div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno">  323</span>            <span class="comment">// Perform CBC Mode decryption</span></div>
<div class="line"><span class="lineno">  324</span>            status = <a class="code hl_function" href="_c_b_c___encrypt_decrypt_8c.html#a0e3b3711796fe07842dba6f5270a4ae4">CBC_EncryptDecrypt</a> (key_size_code, out_str, ct, InitialVector, DecryptionKey, blocks);</div>
<div class="line"><span class="lineno">  325</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  327</span>            <span class="comment">// Perform CTR Mode decryption  (For CTR - DecryptionKey = EncryptionKey)</span></div>
<div class="line"><span class="lineno">  328</span>            <a class="code hl_function" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6">aesCopyInit2</a>(Counter, Nonce);</div>
<div class="line"><span class="lineno">  329</span>            status = <a class="code hl_function" href="_c_t_r___encrypt_decrypt_8c.html#a8be1d9e412dd5bae1da0b130b1c95140">CTR_EncryptDecrypt</a> (key_size_code, out_str, ct, Counter, <a class="code hl_variable" href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a>, blocks);</div>
<div class="line"><span class="lineno">  330</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  331</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  332</span>            <span class="comment">// Perform CBC Mode decryption</span></div>
<div class="line"><span class="lineno">  333</span>            status = <a class="code hl_function" href="_c_b_c___encrypt_decrypt_8c.html#a0e3b3711796fe07842dba6f5270a4ae4">CBC_EncryptDecrypt</a> (key_size_code, out_str, ct, InitialVector, DecryptionKey, blocks);</div>
<div class="line"><span class="lineno">  334</span>    }</div>
<div class="line"><span class="lineno">  335</span>            </div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>    <span class="comment">// Set size of decrypted ciper text, taking into account the padding</span></div>
<div class="line"><span class="lineno">  338</span>    *out_len = in_len - out_str[16 * blocks - 1];</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno">  341</span>}</div>
<div class="ttc" id="a_a_e_s__defs_8h_html_a9b03c222355ee480cac64742c8ba6810a25964629f17803f5ba91a4a2e17be6d1"><div class="ttname"><a href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810a25964629f17803f5ba91a4a2e17be6d1">DECRYPTION_192_BITS</a></div><div class="ttdeci">@ DECRYPTION_192_BITS</div><div class="ttdef"><b>Definition:</b> <a href="_a_e_s__defs_8h_source.html#l00043">AES_defs.h:43</a></div></div>
<div class="ttc" id="a_a_e_s__defs_8h_html_a9b03c222355ee480cac64742c8ba6810a9bb591df6a7d0b56c4f93f9f55d2ae30"><div class="ttname"><a href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810a9bb591df6a7d0b56c4f93f9f55d2ae30">DECRYPTION_128_BITS</a></div><div class="ttdeci">@ DECRYPTION_128_BITS</div><div class="ttdef"><b>Definition:</b> <a href="_a_e_s__defs_8h_source.html#l00042">AES_defs.h:42</a></div></div>
<div class="ttc" id="a_a_e_s__defs_8h_html_a9b03c222355ee480cac64742c8ba6810ae16f041068db0909c54ca8a167a51fa6"><div class="ttname"><a href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810ae16f041068db0909c54ca8a167a51fa6">DECRYPTION_256_BITS</a></div><div class="ttdeci">@ DECRYPTION_256_BITS</div><div class="ttdef"><b>Definition:</b> <a href="_a_e_s__defs_8h_source.html#l00044">AES_defs.h:44</a></div></div>
<div class="ttc" id="a_c_b_c___encrypt_decrypt_8c_html_a0e3b3711796fe07842dba6f5270a4ae4"><div class="ttname"><a href="_c_b_c___encrypt_decrypt_8c.html#a0e3b3711796fe07842dba6f5270a4ae4">CBC_EncryptDecrypt</a></div><div class="ttdeci">CBC_ENCRYPT_DECRYPT_STATUS CBC_EncryptDecrypt(CBC_ENCRYPT_DECRYPT_OPERATION operation, VARIABLE_SEGMENT_POINTER(plainText, U8, SEG_XDATA), VARIABLE_SEGMENT_POINTER(cipherText, U8, SEG_XDATA), VARIABLE_SEGMENT_POINTER(initialVector, U8, SEG_XDATA), VARIABLE_SEGMENT_POINTER(key, U8, SEG_XDATA), U16 blocks)</div><div class="ttdef"><b>Definition:</b> <a href="_c_b_c___encrypt_decrypt_8c_source.html#l00115">CBC_EncryptDecrypt.c:115</a></div></div>
<div class="ttc" id="a_c_t_r___encrypt_decrypt_8c_html_a8be1d9e412dd5bae1da0b130b1c95140"><div class="ttname"><a href="_c_t_r___encrypt_decrypt_8c.html#a8be1d9e412dd5bae1da0b130b1c95140">CTR_EncryptDecrypt</a></div><div class="ttdeci">CTR_ENCRYPT_DECRYPT_STATUS CTR_EncryptDecrypt(CTR_ENCRYPT_DECRYPT_OPERATION operation, VARIABLE_SEGMENT_POINTER(plainText, U8, SEG_XDATA), VARIABLE_SEGMENT_POINTER(cipherText, U8, SEG_XDATA), VARIABLE_SEGMENT_POINTER(counter, U8, SEG_XDATA), VARIABLE_SEGMENT_POINTER(encryptionKey, U8, SEG_XDATA), U16 blocks)</div><div class="ttdef"><b>Definition:</b> <a href="_c_t_r___encrypt_decrypt_8c_source.html#l00101">CTR_EncryptDecrypt.c:101</a></div></div>
<div class="ttc" id="aaes_8c_html_a154f11ed8a65a8d0e4b925b1eaa467ed"><div class="ttname"><a href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a></div><div class="ttdeci">__xdata unsigned char * EncryptionKey</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00041">aes.c:41</a></div></div>
<div class="ttc" id="aaes_8c_html_a1b40943f7b432a2e9e78a8fb5f5759e6"><div class="ttname"><a href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6">aesCopyInit2</a></div><div class="ttdeci">void aesCopyInit2(__xdata unsigned char *dest, __code unsigned char *source)</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00106">aes.c:106</a></div></div>
<div class="ttc" id="aaes_8c_html_a4d425db069534a0125d42f764e943cee"><div class="ttname"><a href="aes_8c.html#a4d425db069534a0125d42f764e943cee">aes_get_encryption_level</a></div><div class="ttdeci">uint8_t aes_get_encryption_level()</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00082">aes.c:82</a></div></div>
<div class="ttc" id="aaes_8c_html_a6302156c124f3a1ca3b0f66f9660a64e"><div class="ttname"><a href="aes_8c.html#a6302156c124f3a1ca3b0f66f9660a64e">CRYPTO</a></div><div class="ttdeci">#define CRYPTO(_l)</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00058">aes.c:58</a></div></div>
<div class="ttc" id="aaes_8c_html_a72f72d2df0c60ca20c904e74bf08a5e8"><div class="ttname"><a href="aes_8c.html#a72f72d2df0c60ca20c904e74bf08a5e8">BITS</a></div><div class="ttdeci">#define BITS(_l)</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00056">aes.c:56</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_a2757ace1790e3c4735f71d304bc3c58b_cgraph.png" border="0" usemap="#aaes_8c_a2757ace1790e3c4735f71d304bc3c58b_cgraph" alt=""/></div>
<map name="aaes_8c_a2757ace1790e3c4735f71d304bc3c58b_cgraph" id="aaes_8c_a2757ace1790e3c4735f71d304bc3c58b_cgraph">
<area shape="rect" title=" " alt="" coords="5,97,99,123"/>
<area shape="rect" href="aes_8c.html#a4d425db069534a0125d42f764e943cee" title=" " alt="" coords="153,5,287,47"/>
<area shape="rect" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6" title=" " alt="" coords="171,71,269,98"/>
<area shape="rect" href="_c_b_c___encrypt_decrypt_8c.html#a0e3b3711796fe07842dba6f5270a4ae4" title=" " alt="" coords="147,122,293,149"/>
<area shape="rect" href="_c_t_r___encrypt_decrypt_8c.html#a8be1d9e412dd5bae1da0b130b1c95140" title=" " alt="" coords="148,173,292,199"/>
<area shape="rect" href="_c_t_r___encrypt_decrypt_8c.html#ae35dade40e11839185f8ba4796da03e9" title=" " alt="" coords="341,173,465,199"/>
</map>
</div>

</div>
</div>
<a id="ac3ab42619f8a65c17754fb46b3e0dfac" name="ac3ab42619f8a65c17754fb46b3e0dfac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3ab42619f8a65c17754fb46b3e0dfac">&#9670;&nbsp;</a></span>aes_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t aes_encrypt </td>
          <td>(</td>
          <td class="paramtype">__xdata unsigned char *&#160;</td>
          <td class="paramname"><em>in_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>in_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__xdata unsigned char *&#160;</td>
          <td class="paramname"><em>out_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00191">191</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  193</span>{</div>
<div class="line"><span class="lineno">  194</span>    uint8_t encryption;</div>
<div class="line"><span class="lineno">  195</span>    uint8_t crypto_type;</div>
<div class="line"><span class="lineno">  196</span>    int8_t key_size_code;</div>
<div class="line"><span class="lineno">  197</span>    uint8_t status;</div>
<div class="line"><span class="lineno">  198</span>    uint8_t blocks;</div>
<div class="line"><span class="lineno">  199</span>    __xdata <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *pt;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="comment">// Make sure we have something to encrypt</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">if</span> (in_len == 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="comment">// Get Encryption Level</span></div>
<div class="line"><span class="lineno">  205</span>    encryption = <a class="code hl_function" href="aes_8c.html#a4d425db069534a0125d42f764e943cee">aes_get_encryption_level</a>();</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="comment">// From the encryption level, determine code for # of bits for AES functions</span></div>
<div class="line"><span class="lineno">  208</span>    <span class="comment">// ENCRYPTION_128_BITS,                // 0x04</span></div>
<div class="line"><span class="lineno">  209</span>    <span class="comment">// ENCRYPTION_192_BITS,                // 0x05</span></div>
<div class="line"><span class="lineno">  210</span>    <span class="comment">// ENCRYPTION_256_BITS,                // 0x06</span></div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">switch</span> (<a class="code hl_define" href="aes_8c.html#a72f72d2df0c60ca20c904e74bf08a5e8">BITS</a>(encryption))</div>
<div class="line"><span class="lineno">  212</span>    {</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  214</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810ab991775e8d0b86ed95643f72414f059d">ENCRYPTION_128_BITS</a>;</div>
<div class="line"><span class="lineno">  215</span>            <span class="keywordflow">break</span>;  </div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno">  217</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810af7b60ed6d8b904075be215265e53c978">ENCRYPTION_192_BITS</a>;</div>
<div class="line"><span class="lineno">  218</span>            <span class="keywordflow">break</span>;  </div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">case</span> 3:</div>
<div class="line"><span class="lineno">  220</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810af64650d0e2066dcbea15536918b741c1">ENCRYPTION_256_BITS</a>;</div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">break</span>;  </div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  223</span>            key_size_code = <a class="code hl_enumvalue" href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810ab991775e8d0b86ed95643f72414f059d">ENCRYPTION_128_BITS</a>;</div>
<div class="line"><span class="lineno">  224</span>    }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    <span class="comment">// Get crypto type...</span></div>
<div class="line"><span class="lineno">  228</span>    <span class="comment">// 0 - CBC</span></div>
<div class="line"><span class="lineno">  229</span>    <span class="comment">// 1 - CTR</span></div>
<div class="line"><span class="lineno">  230</span>    crypto_type = <a class="code hl_define" href="aes_8c.html#a6302156c124f3a1ca3b0f66f9660a64e">CRYPTO</a>(encryption);</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="comment">// We always pad the blocks with up to max 16 bytes.</span></div>
<div class="line"><span class="lineno">  233</span>    <span class="comment">// If we don&#39;t find a pile of 10 10 10....10 in the last block</span></div>
<div class="line"><span class="lineno">  234</span>    <span class="comment">// then we know that the last block was incomplete</span></div>
<div class="line"><span class="lineno">  235</span>    <span class="comment">// e.g. 01 02 03 05 06 01 02 03 05 06 06 01 was just 15 bytes long...and the</span></div>
<div class="line"><span class="lineno">  236</span>    <span class="comment">// last byte is a 01...is padding</span></div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    <span class="comment">// Copy String into XDATA</span></div>
<div class="line"><span class="lineno">  239</span>    pt = <a class="code hl_function" href="aes_8c.html#a4f0b7e8b1dd9c73ef8d91552e55d538b">aes_pad</a>(in_str, in_len); </div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    <span class="comment">// Calculate # of blocks we need to encrypt</span></div>
<div class="line"><span class="lineno">  242</span>    blocks = 1 + (in_len&gt;&gt;4); <span class="comment">// Number of 16-byte blocks to encrypt</span></div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">// Based on crypto_type, perform the encryption</span></div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">switch</span>(crypto_type)</div>
<div class="line"><span class="lineno">  246</span>    {</div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno">  248</span>            <span class="comment">// Validate CBC Mode encryption</span></div>
<div class="line"><span class="lineno">  249</span>            status = <a class="code hl_function" href="_c_b_c___encrypt_decrypt_8c.html#a0e3b3711796fe07842dba6f5270a4ae4">CBC_EncryptDecrypt</a> (key_size_code, pt, out_str, InitialVector, <a class="code hl_variable" href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a>, blocks);</div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  251</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  252</span>            <span class="comment">// Perform CTR Mode decryption</span></div>
<div class="line"><span class="lineno">  253</span>            <a class="code hl_function" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6">aesCopyInit2</a>(Counter, Nonce);</div>
<div class="line"><span class="lineno">  254</span>            status = <a class="code hl_function" href="_c_t_r___encrypt_decrypt_8c.html#a8be1d9e412dd5bae1da0b130b1c95140">CTR_EncryptDecrypt</a> (key_size_code, pt, out_str, Counter, <a class="code hl_variable" href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a>, blocks);</div>
<div class="line"><span class="lineno">  255</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  257</span>            <span class="comment">// Validate CBC Mode encryption</span></div>
<div class="line"><span class="lineno">  258</span>            status = <a class="code hl_function" href="_c_b_c___encrypt_decrypt_8c.html#a0e3b3711796fe07842dba6f5270a4ae4">CBC_EncryptDecrypt</a> (key_size_code, pt, out_str, InitialVector, <a class="code hl_variable" href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a>, blocks);</div>
<div class="line"><span class="lineno">  259</span>    }</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    <span class="comment">// Set size of encrypted cipher in bytes</span></div>
<div class="line"><span class="lineno">  262</span>    *out_len = 16 * blocks;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno">  265</span>}</div>
<div class="ttc" id="a_a_e_s__defs_8h_html_a9b03c222355ee480cac64742c8ba6810ab991775e8d0b86ed95643f72414f059d"><div class="ttname"><a href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810ab991775e8d0b86ed95643f72414f059d">ENCRYPTION_128_BITS</a></div><div class="ttdeci">@ ENCRYPTION_128_BITS</div><div class="ttdef"><b>Definition:</b> <a href="_a_e_s__defs_8h_source.html#l00046">AES_defs.h:46</a></div></div>
<div class="ttc" id="a_a_e_s__defs_8h_html_a9b03c222355ee480cac64742c8ba6810af64650d0e2066dcbea15536918b741c1"><div class="ttname"><a href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810af64650d0e2066dcbea15536918b741c1">ENCRYPTION_256_BITS</a></div><div class="ttdeci">@ ENCRYPTION_256_BITS</div><div class="ttdef"><b>Definition:</b> <a href="_a_e_s__defs_8h_source.html#l00048">AES_defs.h:48</a></div></div>
<div class="ttc" id="a_a_e_s__defs_8h_html_a9b03c222355ee480cac64742c8ba6810af7b60ed6d8b904075be215265e53c978"><div class="ttname"><a href="_a_e_s__defs_8h.html#a9b03c222355ee480cac64742c8ba6810af7b60ed6d8b904075be215265e53c978">ENCRYPTION_192_BITS</a></div><div class="ttdeci">@ ENCRYPTION_192_BITS</div><div class="ttdef"><b>Definition:</b> <a href="_a_e_s__defs_8h_source.html#l00047">AES_defs.h:47</a></div></div>
<div class="ttc" id="aaes_8c_html_a4f0b7e8b1dd9c73ef8d91552e55d538b"><div class="ttname"><a href="aes_8c.html#a4f0b7e8b1dd9c73ef8d91552e55d538b">aes_pad</a></div><div class="ttdeci">__xdata unsigned char * aes_pad(__xdata unsigned char *in_str, uint8_t len)</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00169">aes.c:169</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_cgraph.png" border="0" usemap="#aaes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_cgraph" alt=""/></div>
<map name="aaes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_cgraph" id="aaes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,99,149"/>
<area shape="rect" href="aes_8c.html#a4d425db069534a0125d42f764e943cee" title=" " alt="" coords="153,5,287,47"/>
<area shape="rect" href="aes_8c.html#a4f0b7e8b1dd9c73ef8d91552e55d538b" title=" " alt="" coords="185,71,255,98"/>
<area shape="rect" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6" title=" " alt="" coords="171,122,269,149"/>
<area shape="rect" href="_c_b_c___encrypt_decrypt_8c.html#a0e3b3711796fe07842dba6f5270a4ae4" title=" " alt="" coords="147,173,293,199"/>
<area shape="rect" href="_c_t_r___encrypt_decrypt_8c.html#a8be1d9e412dd5bae1da0b130b1c95140" title=" " alt="" coords="148,223,292,250"/>
<area shape="rect" href="_c_t_r___encrypt_decrypt_8c.html#ae35dade40e11839185f8ba4796da03e9" title=" " alt="" coords="341,223,465,250"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_icgraph.png" border="0" usemap="#aaes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_icgraph" alt=""/></div>
<map name="aaes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_icgraph" id="aaes_8c_ac3ab42619f8a65c17754fb46b3e0dfac_icgraph">
<area shape="rect" title=" " alt="" coords="417,5,511,32"/>
<area shape="rect" href="packet_8c.html#ad4d746c1793a18cdded5a7b51e80e757" title=" " alt="" coords="267,5,369,32"/>
<area shape="rect" href="packet_8c.html#a5e5219aba6ea3e2119aaee25de0d2af6" title=" " alt="" coords="100,5,219,32"/>
<area shape="rect" href="tdm_8c.html#ad455a2a1cb342bd8b5fc764d2fa8d852" title=" " alt="" coords="5,5,52,32"/>
</map>
</div>

</div>
</div>
<a id="a4d425db069534a0125d42f764e943cee" name="a4d425db069534a0125d42f764e943cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d425db069534a0125d42f764e943cee">&#9670;&nbsp;</a></span>aes_get_encryption_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t aes_get_encryption_level </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00082">82</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   83</span>{</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a>;</div>
<div class="line"><span class="lineno">   85</span>}</div>
<div class="ttc" id="aaes_8c_html_a25b2fc566005e9dace81fd13ce88281e"><div class="ttname"><a href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a></div><div class="ttdeci">uint8_t encryption_level</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00061">aes.c:61</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_a4d425db069534a0125d42f764e943cee_icgraph.png" border="0" usemap="#aaes_8c_a4d425db069534a0125d42f764e943cee_icgraph" alt=""/></div>
<map name="aaes_8c_a4d425db069534a0125d42f764e943cee_icgraph" id="aaes_8c_a4d425db069534a0125d42f764e943cee_icgraph">
<area shape="rect" title=" " alt="" coords="559,81,693,123"/>
<area shape="rect" href="tdm_8c.html#ad455a2a1cb342bd8b5fc764d2fa8d852" title=" " alt="" coords="5,51,52,78"/>
<area shape="rect" href="aes_8c.html#a2757ace1790e3c4735f71d304bc3c58b" title=" " alt="" coords="417,38,511,65"/>
<area shape="rect" href="aes_8c.html#ac3ab42619f8a65c17754fb46b3e0dfac" title=" " alt="" coords="417,89,511,115"/>
<area shape="rect" href="packet_8c.html#ad4d746c1793a18cdded5a7b51e80e757" title=" " alt="" coords="267,114,369,141"/>
<area shape="rect" href="packet_8c.html#a5e5219aba6ea3e2119aaee25de0d2af6" title=" " alt="" coords="100,114,219,141"/>
</map>
</div>

</div>
</div>
<a id="a60cde6c8c3083b96d4a0a2977c14f243" name="a60cde6c8c3083b96d4a0a2977c14f243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60cde6c8c3083b96d4a0a2977c14f243">&#9670;&nbsp;</a></span>aes_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool aes_init </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>encryption_level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00119">119</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  120</span>{</div>
<div class="line"><span class="lineno">  121</span>    uint8_t crypto_type;</div>
<div class="line"><span class="lineno">  122</span>    uint8_t status;</div>
<div class="line"><span class="lineno">  123</span>    int8_t key_size_code;</div>
<div class="line"><span class="lineno">  124</span>    uint8_t bits;</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_function" href="aes_8c.html#a16ef8c9a7a8598356f81d0fa4b18fd1c">aes_set_encryption_level</a>(0);  <span class="comment">// Initially set to zero - no encryption</span></div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">// If encryption level  (first nibble == encryption bits) is zero...no encryption</span></div>
<div class="line"><span class="lineno">  129</span>    bits = <a class="code hl_define" href="aes_8c.html#a72f72d2df0c60ca20c904e74bf08a5e8">BITS</a>(<a class="code hl_variable" href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a>);</div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">if</span> (bits == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="comment">// From the encryption level, determine code for # of bits for AES functions</span></div>
<div class="line"><span class="lineno">  133</span>    key_size_code = bits - 1;</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">// Load Encryption Key</span></div>
<div class="line"><span class="lineno">  136</span>    <a class="code hl_function" href="aes_8c.html#a1d20556fe1e702da2bed17db92095443">aes_initkey</a>();</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">// Generate Decryption Key (Only required by CBC)</span></div>
<div class="line"><span class="lineno">  139</span>    status = <a class="code hl_function" href="_generate_decryption_key_8c.html#ae3f6131cf83ff6de274c139a079bf0c8">GenerateDecryptionKey</a>(<a class="code hl_variable" href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a>, DecryptionKey, key_size_code);</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">if</span> (status != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    <span class="comment">// Get Crypto algo type </span></div>
<div class="line"><span class="lineno">  143</span>    crypto_type = <a class="code hl_define" href="aes_8c.html#a6302156c124f3a1ca3b0f66f9660a64e">CRYPTO</a>(<a class="code hl_variable" href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a>);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="comment">// Based on the crypto algoithm chosen, determine what other step needs to be </span></div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// done and do them</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">switch</span>(crypto_type)</div>
<div class="line"><span class="lineno">  148</span>    {</div>
<div class="line"><span class="lineno">  149</span>        <span class="keywordflow">case</span> 0:</div>
<div class="line"><span class="lineno">  150</span>            <span class="comment">// Initialise IV</span></div>
<div class="line"><span class="lineno">  151</span>            <a class="code hl_function" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6">aesCopyInit2</a>(InitialVector, ReferenceInitialVector);</div>
<div class="line"><span class="lineno">  152</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">case</span> 1:</div>
<div class="line"><span class="lineno">  154</span>            <span class="comment">// Nothing to do. We init &quot;Counter&quot; everytime we do encrypt/decrypt</span></div>
<div class="line"><span class="lineno">  155</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  157</span>            <span class="comment">// Initialise IV</span></div>
<div class="line"><span class="lineno">  158</span>            <a class="code hl_function" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6">aesCopyInit2</a>(InitialVector, ReferenceInitialVector);</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_function" href="aes_8c.html#a16ef8c9a7a8598356f81d0fa4b18fd1c">aes_set_encryption_level</a>(<a class="code hl_variable" href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a>);  <span class="comment">// If up to here, must have been successful</span></div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  164</span>}</div>
<div class="ttc" id="a_generate_decryption_key_8c_html_ae3f6131cf83ff6de274c139a079bf0c8"><div class="ttname"><a href="_generate_decryption_key_8c.html#ae3f6131cf83ff6de274c139a079bf0c8">GenerateDecryptionKey</a></div><div class="ttdeci">GENERATE_DECRYPTION_KEY_STATUS GenerateDecryptionKey(VARIABLE_SEGMENT_POINTER(encryptionKey, U8, SEG_XDATA), VARIABLE_SEGMENT_POINTER(decryptionKey, U8, SEG_XDATA), GENERATE_DECRYPTION_KEY_SIZE keySize)</div><div class="ttdef"><b>Definition:</b> <a href="_generate_decryption_key_8c_source.html#l00084">GenerateDecryptionKey.c:84</a></div></div>
<div class="ttc" id="aaes_8c_html_a16ef8c9a7a8598356f81d0fa4b18fd1c"><div class="ttname"><a href="aes_8c.html#a16ef8c9a7a8598356f81d0fa4b18fd1c">aes_set_encryption_level</a></div><div class="ttdeci">void aes_set_encryption_level(uint8_t encryption)</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00090">aes.c:90</a></div></div>
<div class="ttc" id="aaes_8c_html_a1d20556fe1e702da2bed17db92095443"><div class="ttname"><a href="aes_8c.html#a1d20556fe1e702da2bed17db92095443">aes_initkey</a></div><div class="ttdeci">void aes_initkey()</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00099">aes.c:99</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_a60cde6c8c3083b96d4a0a2977c14f243_cgraph.png" border="0" usemap="#aaes_8c_a60cde6c8c3083b96d4a0a2977c14f243_cgraph" alt=""/></div>
<map name="aaes_8c_a60cde6c8c3083b96d4a0a2977c14f243_cgraph" id="aaes_8c_a60cde6c8c3083b96d4a0a2977c14f243_cgraph">
<area shape="rect" title=" " alt="" coords="5,93,72,120"/>
<area shape="rect" href="aes_8c.html#a1d20556fe1e702da2bed17db92095443" title=" " alt="" coords="156,5,244,32"/>
<area shape="rect" href="aes_8c.html#a16ef8c9a7a8598356f81d0fa4b18fd1c" title=" " alt="" coords="133,57,267,98"/>
<area shape="rect" href="aes_8c.html#a1b40943f7b432a2e9e78a8fb5f5759e6" title=" " alt="" coords="151,123,249,149"/>
<area shape="rect" href="_generate_decryption_key_8c.html#ae3f6131cf83ff6de274c139a079bf0c8" title=" " alt="" coords="120,173,280,200"/>
</map>
</div>

</div>
</div>
<a id="a1d20556fe1e702da2bed17db92095443" name="a1d20556fe1e702da2bed17db92095443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d20556fe1e702da2bed17db92095443">&#9670;&nbsp;</a></span>aes_initkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aes_initkey </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00099">99</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>{</div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_variable" href="aes_8c.html#a154f11ed8a65a8d0e4b925b1eaa467ed">EncryptionKey</a> = param_get_encryption_key();</div>
<div class="line"><span class="lineno">  102</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_a1d20556fe1e702da2bed17db92095443_icgraph.png" border="0" usemap="#aaes_8c_a1d20556fe1e702da2bed17db92095443_icgraph" alt=""/></div>
<map name="aaes_8c_a1d20556fe1e702da2bed17db92095443_icgraph" id="aaes_8c_a1d20556fe1e702da2bed17db92095443_icgraph">
<area shape="rect" title=" " alt="" coords="120,5,208,32"/>
<area shape="rect" href="aes_8c.html#a60cde6c8c3083b96d4a0a2977c14f243" title=" " alt="" coords="5,5,72,32"/>
</map>
</div>

</div>
</div>
<a id="a4f0b7e8b1dd9c73ef8d91552e55d538b" name="a4f0b7e8b1dd9c73ef8d91552e55d538b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f0b7e8b1dd9c73ef8d91552e55d538b">&#9670;&nbsp;</a></span>aes_pad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__xdata unsigned char * aes_pad </td>
          <td>(</td>
          <td class="paramtype">__xdata unsigned char *&#160;</td>
          <td class="paramname"><em>in_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00169">169</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  170</span>{</div>
<div class="line"><span class="lineno">  171</span>    <span class="keyword">volatile</span> uint8_t  pad_length;</div>
<div class="line"><span class="lineno">  172</span>    uint8_t i;</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>        <span class="comment">// Copy string to encrypt to temp area, because we will be padding out encrypted string</span></div>
<div class="line"><span class="lineno">  175</span>        <span class="comment">// and we don&#39;t want to affect any code that might be depending upon this string...or </span></div>
<div class="line"><span class="lineno">  176</span>    <span class="comment">// any characters that the padding would overwrite. e.g. the injected packet code.</span></div>
<div class="line"><span class="lineno">  177</span>        memcpy(<a class="code hl_variable" href="aes_8c.html#a930fb15b8006f70d704902a7118794c6">encrypt_packet</a>, in_str, len);</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    pad_length = 16 - (len%16);</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">for</span> (i = 0; i &lt; pad_length;i++) {</div>
<div class="line"><span class="lineno">  182</span>        memcpy(&amp;<a class="code hl_variable" href="aes_8c.html#a930fb15b8006f70d704902a7118794c6">encrypt_packet</a>[len+i], &amp;pad_length, <span class="keyword">sizeof</span>(pad_length));</div>
<div class="line"><span class="lineno">  183</span>    }</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="aes_8c.html#a930fb15b8006f70d704902a7118794c6">encrypt_packet</a>;</div>
<div class="line"><span class="lineno">  186</span>}</div>
<div class="ttc" id="aaes_8c_html_a930fb15b8006f70d704902a7118794c6"><div class="ttname"><a href="aes_8c.html#a930fb15b8006f70d704902a7118794c6">encrypt_packet</a></div><div class="ttdeci">static __xdata uint8_t encrypt_packet[MAX_ENCRYPT_PACKET_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="aes_8c_source.html#l00052">aes.c:52</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_a4f0b7e8b1dd9c73ef8d91552e55d538b_icgraph.png" border="0" usemap="#aaes_8c_a4f0b7e8b1dd9c73ef8d91552e55d538b_icgraph" alt=""/></div>
<map name="aaes_8c_a4f0b7e8b1dd9c73ef8d91552e55d538b_icgraph" id="aaes_8c_a4f0b7e8b1dd9c73ef8d91552e55d538b_icgraph">
<area shape="rect" title=" " alt="" coords="559,5,629,32"/>
<area shape="rect" href="aes_8c.html#ac3ab42619f8a65c17754fb46b3e0dfac" title=" " alt="" coords="417,5,511,32"/>
<area shape="rect" href="packet_8c.html#ad4d746c1793a18cdded5a7b51e80e757" title=" " alt="" coords="267,5,369,32"/>
<area shape="rect" href="packet_8c.html#a5e5219aba6ea3e2119aaee25de0d2af6" title=" " alt="" coords="100,5,219,32"/>
<area shape="rect" href="tdm_8c.html#ad455a2a1cb342bd8b5fc764d2fa8d852" title=" " alt="" coords="5,5,52,32"/>
</map>
</div>

</div>
</div>
<a id="a16ef8c9a7a8598356f81d0fa4b18fd1c" name="a16ef8c9a7a8598356f81d0fa4b18fd1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ef8c9a7a8598356f81d0fa4b18fd1c">&#9670;&nbsp;</a></span>aes_set_encryption_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aes_set_encryption_level </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>encryption</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00090">90</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>{</div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_variable" href="aes_8c.html#a25b2fc566005e9dace81fd13ce88281e">encryption_level</a> = encryption;</div>
<div class="line"><span class="lineno">   93</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_a16ef8c9a7a8598356f81d0fa4b18fd1c_icgraph.png" border="0" usemap="#aaes_8c_a16ef8c9a7a8598356f81d0fa4b18fd1c_icgraph" alt=""/></div>
<map name="aaes_8c_a16ef8c9a7a8598356f81d0fa4b18fd1c_icgraph" id="aaes_8c_a16ef8c9a7a8598356f81d0fa4b18fd1c_icgraph">
<area shape="rect" title=" " alt="" coords="120,5,255,47"/>
<area shape="rect" href="aes_8c.html#a60cde6c8c3083b96d4a0a2977c14f243" title=" " alt="" coords="5,13,72,39"/>
</map>
</div>

</div>
</div>
<a id="a1b40943f7b432a2e9e78a8fb5f5759e6" name="a1b40943f7b432a2e9e78a8fb5f5759e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b40943f7b432a2e9e78a8fb5f5759e6">&#9670;&nbsp;</a></span>aesCopyInit2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aesCopyInit2 </td>
          <td>(</td>
          <td class="paramtype">__xdata unsigned char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__code unsigned char *&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00106">106</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  107</span>{</div>
<div class="line"><span class="lineno">  108</span>    uint8_t i;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">for</span>(i=16;i&gt;0;i--) {</div>
<div class="line"><span class="lineno">  111</span>        *dest++ = *source++;</div>
<div class="line"><span class="lineno">  112</span>    }</div>
<div class="line"><span class="lineno">  113</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="aes_8c_a1b40943f7b432a2e9e78a8fb5f5759e6_icgraph.png" border="0" usemap="#aaes_8c_a1b40943f7b432a2e9e78a8fb5f5759e6_icgraph" alt=""/></div>
<map name="aaes_8c_a1b40943f7b432a2e9e78a8fb5f5759e6_icgraph" id="aaes_8c_a1b40943f7b432a2e9e78a8fb5f5759e6_icgraph">
<area shape="rect" title=" " alt="" coords="559,56,656,83"/>
<area shape="rect" href="aes_8c.html#a2757ace1790e3c4735f71d304bc3c58b" title=" " alt="" coords="417,5,511,32"/>
<area shape="rect" href="aes_8c.html#ac3ab42619f8a65c17754fb46b3e0dfac" title=" " alt="" coords="417,56,511,83"/>
<area shape="rect" href="aes_8c.html#a60cde6c8c3083b96d4a0a2977c14f243" title=" " alt="" coords="431,107,497,133"/>
<area shape="rect" href="packet_8c.html#ad4d746c1793a18cdded5a7b51e80e757" title=" " alt="" coords="267,56,369,83"/>
<area shape="rect" href="packet_8c.html#a5e5219aba6ea3e2119aaee25de0d2af6" title=" " alt="" coords="100,56,219,83"/>
<area shape="rect" href="tdm_8c.html#ad455a2a1cb342bd8b5fc764d2fa8d852" title=" " alt="" coords="5,56,52,83"/>
</map>
</div>

</div>
</div>
<a id="ad3340193121d38a9a5c492e1df5529da" name="ad3340193121d38a9a5c492e1df5529da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3340193121d38a9a5c492e1df5529da">&#9670;&nbsp;</a></span>INTERRUPT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INTERRUPT </td>
          <td>(</td>
          <td class="paramtype">DMA_ISR&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_si1020__defs_8h.html#a7f9c4337d8bafd18441e4eee6a413847">INTERRUPT_DMA0</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00074">74</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>{</div>
<div class="line"><span class="lineno">   76</span>  EIE2 &amp;= ~0x20;                       <span class="comment">// disable further interrupts</span></div>
<div class="line"><span class="lineno">   77</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ec66ec87d73d65517e9493b838a461a" name="a3ec66ec87d73d65517e9493b838a461a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ec66ec87d73d65517e9493b838a461a">&#9670;&nbsp;</a></span>SEGMENT_VARIABLE() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEGMENT_VARIABLE </td>
          <td>(</td>
          <td class="paramtype">Counter&#160;</td>
          <td class="paramname">[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEG_XDATA&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e599e112e6acafda51081c4ca4fbcf8" name="a2e599e112e6acafda51081c4ca4fbcf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e599e112e6acafda51081c4ca4fbcf8">&#9670;&nbsp;</a></span>SEGMENT_VARIABLE() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEGMENT_VARIABLE </td>
          <td>(</td>
          <td class="paramtype">DecryptionKey&#160;</td>
          <td class="paramname">[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEG_XDATA&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0dc14eb3453afebb659240b6f0163fd3" name="a0dc14eb3453afebb659240b6f0163fd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dc14eb3453afebb659240b6f0163fd3">&#9670;&nbsp;</a></span>SEGMENT_VARIABLE() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEGMENT_VARIABLE </td>
          <td>(</td>
          <td class="paramtype">InitialVector&#160;</td>
          <td class="paramname">[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEG_XDATA&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a66557124ad1cbe4739c59fbd3e349de1" name="a66557124ad1cbe4739c59fbd3e349de1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66557124ad1cbe4739c59fbd3e349de1">&#9670;&nbsp;</a></span>SEGMENT_VARIABLE() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const SEGMENT_VARIABLE </td>
          <td>(</td>
          <td class="paramtype">Nonce&#160;</td>
          <td class="paramname">[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEG_CODE&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a05d3f9b0caaac236e8b2d6b2b6825091" name="a05d3f9b0caaac236e8b2d6b2b6825091"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05d3f9b0caaac236e8b2d6b2b6825091">&#9670;&nbsp;</a></span>SEGMENT_VARIABLE() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const SEGMENT_VARIABLE </td>
          <td>(</td>
          <td class="paramtype">ReferenceInitialVector&#160;</td>
          <td class="paramname">[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U8&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEG_CODE&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a930fb15b8006f70d704902a7118794c6" name="a930fb15b8006f70d704902a7118794c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a930fb15b8006f70d704902a7118794c6">&#9670;&nbsp;</a></span>encrypt_packet</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">__xdata uint8_t encrypt_packet[<a class="el" href="aes_8c.html#a941c7647f6eb232d5d8e5e736c51b05e">MAX_ENCRYPT_PACKET_LENGTH</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00052">52</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<a id="a25b2fc566005e9dace81fd13ce88281e" name="a25b2fc566005e9dace81fd13ce88281e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b2fc566005e9dace81fd13ce88281e">&#9670;&nbsp;</a></span>encryption_level</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t encryption_level</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00061">61</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
<a id="a154f11ed8a65a8d0e4b925b1eaa467ed" name="a154f11ed8a65a8d0e4b925b1eaa467ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a154f11ed8a65a8d0e4b925b1eaa467ed">&#9670;&nbsp;</a></span>EncryptionKey</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__xdata unsigned char* EncryptionKey</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="aes_8c_source.html#l00041">41</a> of file <a class="el" href="aes_8c_source.html">aes.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_167790342fb55959539d550b874be046.html">project</a></li><li class="navelem"><a class="el" href="dir_1f2ad38bfb88044c84a19a4ab80ce531.html">Firmware</a></li><li class="navelem"><a class="el" href="dir_412cb633748d7ebdc68292eb7d392d68.html">radio</a></li><li class="navelem"><a class="el" href="dir_d911b2054f5a1979da686ef15597be55.html">AES</a></li><li class="navelem"><a class="el" href="aes_8c.html">aes.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
